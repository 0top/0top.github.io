<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>zerotop</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="my github page">
<meta name="keywords" content="zerotop">
<meta property="og:type" content="website">
<meta property="og:title" content="zerotop">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="zerotop">
<meta property="og:description" content="my github page">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="zerotop">
<meta name="twitter:description" content="my github page">
  
    <link rel="alternate" href="/atom.xml" title="zerotop" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">zerotop</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-数据库" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/27/数据库/" class="article-date">
  <time datetime="2018-11-27T14:01:58.000Z" itemprop="datePublished">2018-11-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/27/数据库/">数据库</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>正常做项目我们可以选择使用<br>mybatis, JPA, Hibernate</p>
<h3 id="mybatis"><a href="#mybatis" class="headerlink" title="mybatis"></a>mybatis</h3><p>可以直接写sql</p>
<h3 id="JPA"><a href="#JPA" class="headerlink" title="JPA"></a>JPA</h3><p>可以通过名字代替sql<br>比如getUserByUserName</p>
<p>底层使用EntityManager进行持久化</p>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>留坑</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/27/数据库/" data-id="cjp47gfb2000fs820405bg69o" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/database/">database</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-git-server" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/15/git-server/" class="article-date">
  <time datetime="2018-11-15T14:14:06.000Z" itemprop="datePublished">2018-11-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/15/git-server/">git server</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>我们使用github时候，不花钱的话只能公开<br>于是我们便有了搭建git服务器的需求</p>
<h3 id="git-服务器"><a href="#git-服务器" class="headerlink" title="git 服务器"></a>git 服务器</h3><p>git其实只是一款应用<br>我们可以在服务器上直接安装  </p>
<p>安装后我们需要设置连接方式<br>可以使用无需密码的ssh连接方式</p>
<p>重点是需要将本地公钥传到服务器上，即id_rsa.pub<br>我们可以通过git bash在本地生成ssh key<br>然后将公钥写入服务器git中的authorized_keys</p>
<p>过程类似github.io使用ssh方式上传，详细之后有时间再更新</p>
<h3 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h3><p>我们可以搭建git服务器<br>也可以再搭建一波wiki  </p>
<p>祝大家可以玩更多骚操作</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/15/git-server/" data-id="cjp47gfas0006s8206miywvyj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-书" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/31/书/" class="article-date">
  <time datetime="2018-10-31T15:25:45.000Z" itemprop="datePublished">2018-10-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/31/书/">书</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>人还是要有些追求的,本篇主要记录自己看的书<br>希望能在空余时间一直看下去  </p>
<h3 id="书目"><a href="#书目" class="headerlink" title="书目"></a>书目</h3><ol>
<li>基督山伯爵  </li>
<li>罪与罚  </li>
<li>人生若只如初见  </li>
<li>鼠疫  </li>
<li>人格裂变的姑娘(讲多重人格的)  </li>
<li>肖申克的救赎</li>
<li>国富论</li>
<li>荆棘鸟</li>
<li>安娜卡列宁娜</li>
<li>较量</li>
</ol>
<h3 id="推荐"><a href="#推荐" class="headerlink" title="推荐"></a>推荐</h3><p>基督山伯爵:<br>故事很好，让人很有读下去的欲望<br>而且和希望遇到神甫那样睿智，强大的人</p>
<p>人生若只如初见:<br>读了前一部分感觉古诗词真的很美</p>
<h3 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h3><p>个人见解，希望更优秀  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/31/书/" data-id="cjp47gfb1000cs820arae0c3h" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/other/">other</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-cors" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/24/cors/" class="article-date">
  <time datetime="2018-10-24T15:21:28.000Z" itemprop="datePublished">2018-10-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/24/cors/">cors</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>此篇文章是在下html结合ajax时出现的问题<br>以下是从遇到跨域问题，到一步步解决的过程<br>如果需要了解的可以看看  </p>
<p>微信公众号：zerotop(私信联系方式，我会联系您的)<br>github: <a href="https://github.com/0top" target="_blank" rel="noopener">https://github.com/0top</a></p>
<h3 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h3><p>跨域是一个和 浏览器的同源策略 有关的东西<br>前后端分离开发经常会遇到这个问题  </p>
<p>三种解决方案:</p>
<p>1.jsonp：  </p>
<p>jsonp方案需要后端配合，所以最好使用node将数据转发到后端</p>
<p>然后再通过拼接jsonp的callback函数</p>
<p>通过服务器端转发请求也可以</p>
<p>2.设置代理： </p>
<p>代理暂时使用node中间件或者可以配置nigix代理</p>
<p>3.后端允许跨域:</p>
<p>cors跨域资源共享</p>
<h3 id="场景1"><a href="#场景1" class="headerlink" title="场景1"></a>场景1</h3><p>ajax请求后端接口时候<br>1.本地直接打开的静态页面<br>2.本地服务器(tomcat)打开的页面:<a href="http://localhost:8088" target="_blank" rel="noopener">http://localhost:8088</a>  </p>
<p>请求远程地址:<a href="http://xxx.xxx.xxx.xx:8888" target="_blank" rel="noopener">http://xxx.xxx.xxx.xx:8888</a></p>
<p>两个地址不同源，这个时候就会产生跨域问题</p>
<p>这个时候可以用node代理解决(nigix代理之后会接触)  </p>
<h3 id="场景1解决"><a href="#场景1解决" class="headerlink" title="场景1解决"></a>场景1解决</h3><p>直接使用node后端设置代理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&apos;express&apos;);</span><br><span class="line">var proxy = require(&apos;http-proxy-middleware&apos;);</span><br><span class="line">var app = express();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var options = &#123;</span><br><span class="line">    target: &apos;http://xxx.xxx.xxx.xx:8888&apos;,</span><br><span class="line">    changeOrigin: true,</span><br><span class="line">    pathRewrite: &#123;</span><br><span class="line">        &apos;^/api/&apos; : &apos;http://xxx.xxx.xxx.xx:8888&apos;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">var exampleProxy = proxy(options);  </span><br><span class="line"></span><br><span class="line">app.use(&apos;/&apos;,exampleProxy);//对地址为’/‘的请求全部转发</span><br><span class="line"></span><br><span class="line">app.listen(8088);</span><br></pre></td></tr></table></figure></p>
<p>这样可以将:   <a href="http://xxx.xxx.xxx.xx:8088/api/info" target="_blank" rel="noopener">http://xxx.xxx.xxx.xx:8088/api/info</a><br>请求全部转发到:<a href="http://xxx.xxx.xxx.xx:8888/info" target="_blank" rel="noopener">http://xxx.xxx.xxx.xx:8888/info</a></p>
<p>这个时候会产生场景2的问题  </p>
        
          <p class="article-more-link">
            <a href="/2018/10/24/cors/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/24/cors/" data-id="cjp47gfap0004s8209wffx8ml" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-权限验证" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/17/权限验证/" class="article-date">
  <time datetime="2018-10-17T14:15:34.000Z" itemprop="datePublished">2018-10-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/17/权限验证/">权限验证</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>shiro中权限管理<br>首先是角色<br>一个人对应多个角色<br>每个角色都拥有固定的权限<br>或者也可以给相关用户添加权限  </p>
<p>相对于某个页面或者操作，我们都需要有对应的权限<br>在查询权限是，首先是针对当前用户查询其拥有的权限<br>然后进行授权操作  </p>
<p>换取token过程对服务器性能要求比较高</p>
<h3 id="权限"><a href="#权限" class="headerlink" title="权限"></a>权限</h3><p>0Auth2.0</p>
<p>我们可以专门做一个高性能的认证服务器，从服务器中换取token，然后可以直接登录，而不用每次都去认证。可以在token中添加过期时间等信息。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/17/权限验证/" data-id="cjp47gfb4000gs820nz7xxqod" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shiro/">shiro</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-poi读取值" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/10/poi读取值/" class="article-date">
  <time datetime="2018-10-10T15:39:03.000Z" itemprop="datePublished">2018-10-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/10/poi读取值/">poi读取值</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>excel中单元格看到的值并不是真实的值<br>而且和自定义格式关系是一门玄学<br>有时候设置的单元格格式和实际的值，在程序中读取的是不一致的<br>详情可以往继续往下读</p>
<h3 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h3><p>今天lz在用poi读取excel发现了一个奇怪的数值,excel表中：<br>字面值：10月9日<br>编辑值：2018/10/9<br>读取值：43382</p>
<p>这明显不对啊，读取一波  cell.getCellType()<br>预计是：Cell.CELL_TYPE_NUMERIC<br>实际是：Cell.CELL_TYPE_STRING</p>
<p>顿时黑线，string类型单元格只能读取原始值<br> Cell.CELL_TYPE_STRING格式可以直接读取cell中的值<br>读完是43382  完全没法转化为日期格式啊</p>
<p>网上查了一下，  没有看到有人遇到这个鬼畜问题<br>所有的读取都是跟官方文档一致的方式(读取数值型会有扩展)<br>上一篇POI中提到过数据读取的方式<br>虽然悲痛，但是还是要寻求解决方案  </p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>尝试了n多种方法，无法读取到string值后格式化为原来的日期<br>查看了一下以下两个值：<br>cell.getCellStyle().getDataFormat()        ：0<br>cell.getCellStyle().getDataFormatString()  ：General<br>瞬间崩溃，如此坑爹新奇的单元格还是第一次见  </p>
        
          <p class="article-more-link">
            <a href="/2018/10/10/poi读取值/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/10/poi读取值/" data-id="cjp47gfb9000hs8208c8ixfjf" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/POI/">POI</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-中间件" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/05/中间件/" class="article-date">
  <time datetime="2018-10-05T14:21:48.000Z" itemprop="datePublished">2018-10-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/05/中间件/">中间件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h3><p>本篇文章主要是讨论一些常用的中间件</p>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>首先会使用rabbitmq<br>rabbitmq支持stomp协议</p>
<p>安装rabbitmq需要安装Erlang(需要翻墙)</p>
<h3 id="node中间件"><a href="#node中间件" class="headerlink" title="node中间件"></a>node中间件</h3><p>在解决跨域问题时，使用到了node端中间件<br>var proxy = require(‘http-proxy-middleware’);<br>可以直接将请求代理到后端，后端无需设置跨域  </p>
<h3 id="tomcat"><a href="#tomcat" class="headerlink" title="tomcat"></a>tomcat</h3><p>tomcat等容器也算是中间件</p>
<h3 id="待续"><a href="#待续" class="headerlink" title="待续"></a>待续</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/05/中间件/" data-id="cjp47gfay000bs8209mdbxzo4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/中间件/">中间件</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Regular-expression" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/30/Regular-expression/" class="article-date">
  <time datetime="2018-09-30T13:40:23.000Z" itemprop="datePublished">2018-09-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/30/Regular-expression/">Regular expression</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>本篇文章内容主要是在学习正则表达式中记录的一些笔记<br>希望能对你有所帮助  </p>
<h3 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h3><p>有需要的朋友可以去这个地址看正则相关内容<br><a href="https://www.regular-expressions.info/tutorial.html" target="_blank" rel="noopener">https://www.regular-expressions.info/tutorial.html</a></p>
<p>关于正则测试工具: regexbuddy<br>可以查看正则匹配的过程，便于优化  </p>
<h3 id="记录"><a href="#记录" class="headerlink" title="记录"></a>记录</h3><p><a href="https://www.regular-expressions.info/repeat.html" target="_blank" rel="noopener">https://www.regular-expressions.info/repeat.html</a></p>
<p>1.匹配过程：<br>贪婪： 通过&lt;.+&gt; 匹配  This is a <em>first</em> test<br>在匹配到&lt;之后，.+会直接匹配到字符串最后t，发现结果未匹配成功<br>开始回溯，到s位置，发现未匹配成功，继续向前回溯，<br>最终在M处匹配成功。<br>匹配结果：  &lt;EM>first&lt;/EM></p>
<p>非贪婪： 通过&lt;.+?&gt; 匹配  This is a <em>first</em> test<br>在匹配到&lt;之后，正则引擎匹配E发现结果不匹配，进行回溯<br>但是在非贪婪模式下的回溯为扩张，所以继续匹配M，结果成功<br>匹配结果：  &lt;EM> </p>
<p>对于此类匹配，更优的正则式为：  &lt;[^&gt;]+&gt;<br>[^&gt;]+ 表示匹配多个非&gt;号的符号</p>
<p>2.对于[]:<br>It is important to remember that a negated character class<br>still must match a character<br>意思是一个中括号需要匹配字符，<br>q[^u]   不会匹配   Iraq 因为q后没有字符<br>但是会匹配Iraq is a country.</p>
<p>如果想匹配    q后面不是u 以及单纯只有一个q<br>正则式： q(?!u)  </p>
<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><h5 id="Anchor-锚点"><a href="#Anchor-锚点" class="headerlink" title="Anchor 锚点"></a>Anchor 锚点</h5><p>caret ：  ^匹配插入字符第一个字符前面的位置<br>dollar：  $匹配插入字符最后一个字符后面位置<br>以上两个会在不同的语言中匹配不同，因为如果有多行数据，可能会只匹配一行<br>/A    字符串开头<br>/Z     字符串结尾<br>永远只只对于数据的开头和结尾，不受多行字符串影响(部分不支持)  </p>
<p>negated character classes also match (invisible) line break characters.<br>否定的字符类也匹配（不可见）换行符。<br>[^0-9]      [^0-9\r\n]matches any character that is not a digit or a line break.  </p>
<p>[x^] matches an x or a caret.  –^不放到[]开头位置即可，不需要转义<br>[]x] matches a closing bracket or an x<br>[^]x] matches any character that is not a closing bracket or an x<br>This does not work in JavaScript,  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/09/30/Regular-expression/" data-id="cjp47gfal0002s8209ksv7m7n" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-POI" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/25/POI/" class="article-date">
  <time datetime="2018-09-25T12:51:07.000Z" itemprop="datePublished">2018-09-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/25/POI/">POI</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h3><p>poi即Poor Obfuscation Implementatio<br>poi是Apache软件基金会的开放源码函式库<br>java程序开发者可以使用poi提供的api读取Microsoft Office文件<br>excel, word, PowerPoint等<br>以下内容会简述excel读取相关的一些内容<br><a href="https://poi.apache.org/" title="poi" target="_blank" rel="noopener">https://poi.apache.org/</a></p>
<h3 id="poi"><a href="#poi" class="headerlink" title="poi"></a>poi</h3><h3 id="1-格式"><a href="#1-格式" class="headerlink" title="1.格式"></a>1.格式</h3><p>  HSSF - 可以读取.xls文件<br>  XSSF - 可以读取.xlsx文件</p>
<h3 id="2-poi模型"><a href="#2-poi模型" class="headerlink" title="2.poi模型"></a>2.poi模型</h3><p>poi将excel中的模型都定义到org.apache.poi.ss.usermodel包中<br>比如workbook，sheet，cell等<br>通过操纵这些模型对应excel<br>我们可以创建或者解析excel文件</p>
<h3 id="3-读取"><a href="#3-读取" class="headerlink" title="3.读取"></a>3.读取</h3><p>excel读取重点在于解析cell表格中的数据  </p>
<p>excel表格中的单元格由不同的单元格格式具有不同的dataformate<br>但单元格内容决定因素是单元格中的值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cell.getCellStyle().getDataFormat()  </span><br><span class="line">cell.getCellStyle().getDataFormatString()</span><br></pre></td></tr></table></figure></p>
<p>cell中值七种形式:<br>_NONE、BLANK、BOOLEAN、ERROR、FORMULA、NUMERIC、STRING<br>首先对于numeric类型的cell，我们可以读取日历和数字格式<br>“@”即取文本格式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DataFormatter formatter = new DataFormatter(&apos;zh&apos;, true);</span><br><span class="line">if (cell.getCellType() == Cell.CELL_TYPE_NUMERIC) &#123;</span><br><span class="line">  //日历   </span><br><span class="line">  if (DateUtil..isCellDateFormatted(cell)) &#123;</span><br><span class="line">	Date date = cell.getDateCellValue();</span><br><span class="line">    SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span><br><span class="line">    val = sdf.format(date);</span><br><span class="line">  &#125;</span><br><span class="line">  if (format == 14 || format == 31 || format == 57 || format == 58  </span><br><span class="line">           || (176&lt;=format  &amp;&amp; format&lt;=184)) &#123;</span><br><span class="line">     val = formatter.formatRawCellContents(cell.getNumericCellValue(), 0, &quot;yyy-mm-dd&quot;);</span><br><span class="line">  &#125; else &#123; </span><br><span class="line">     val = formatter.formatRawCellContents(cell.getNumericCellValue(), 0, &quot;@&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>对于公式类型的，即单元格中的值通过其他单元格组合计算出来的<br>需要取出计算后的值：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">FormulaEvaluator evaluator = null;</span><br><span class="line">if (cell instanceof HSSFFormulaEvaluator) &#123;</span><br><span class="line">  evaluator = new HSSFFormulaEvaluator((HSSFFormulaEvaluator)sheet.getWorkbook());</span><br><span class="line">&#125;</span><br><span class="line">if (cell instanceof XSSFFormulaEvaluator) &#123;</span><br><span class="line">  evaluator = new XSSFFormulaEvaluator((XSSFFormulaEvaluator)sheet.getWorkbook());</span><br><span class="line">&#125;</span><br><span class="line">val = evaluator.evaluateFormulaCell(cell);</span><br></pre></td></tr></table></figure></p>
        
          <p class="article-more-link">
            <a href="/2018/09/25/POI/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/09/25/POI/" data-id="cjp47gfaf0001s8209102mju8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/POI/">POI</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-websocket" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/13/websocket/" class="article-date">
  <time datetime="2018-09-13T14:39:23.000Z" itemprop="datePublished">2018-09-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/13/websocket/">websocket</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="websocket简介"><a href="#websocket简介" class="headerlink" title="websocket简介"></a>websocket简介</h3><p>websocket即所谓的长连接<br>我们可以在连接后和服务器持续保持连接<br>跟轮询或ajax模拟相比，是真正意义上的长连接</p>
<p>ps：<br>websocket是浏览器自带支持的<br>可以在浏览器的console中输入window.WebSocket查看</p>
<h3 id="websocket的使用"><a href="#websocket的使用" class="headerlink" title="websocket的使用"></a>websocket的使用</h3><p>对于websocket的使用，我们可以直接根据MDN上的<a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket" title="websocketAPI" target="_blank" rel="noopener">websocketAPI</a>去创建  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var websocket = new WebSocket(&quot;ws://localhost:8088&quot;);  </span><br><span class="line">websocket.onopen = function(event) &#123;</span><br><span class="line">  console.log(&quot;WebSocket is open now.&quot;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>其他监听事件类似，发送消息可用<br><code>websocket.send(&#39;msg&#39;)</code></p>
<p>服务端可以直接用第三方库使用  </p>
<h3 id="java和websocket"><a href="#java和websocket" class="headerlink" title="java和websocket"></a>java和websocket</h3><p>websocket， socketJS， stomp</p>
<p>在浏览器不支持websocket时，socketJS可模拟一个websocket<br>可以理解为其实就是websocket  </p>
<p>而stomp是作用在这两个底层协议之上的协议<br>这个协议规范了websocket中没有规范的消息的内容<br>消息内容作了规范之后，我们便可以区分指令  </p>
<h3 id="后台"><a href="#后台" class="headerlink" title="后台"></a>后台</h3><p>通过stomp，我们可以接收send，subscribe等请求<br>在前端连接后，可以订阅多个频道，<br>后端可以直接对订阅的topic地址发送消息</p>
<h3 id="文档地址"><a href="#文档地址" class="headerlink" title="文档地址"></a>文档地址</h3><p><a href="http://jmesnil.net/stomp-websocket/doc/" title="sockjs地址" target="_blank" rel="noopener">http://jmesnil.net/stomp-websocket/doc/</a></p>
<h3 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h3><p>rabbitmq 以后会使用这个消息队列中间件<br>rabbitmq 需要下载Erlang，跟着流程下载就好了  </p>
<h3 id="websocket"><a href="#websocket" class="headerlink" title="websocket"></a>websocket</h3><p>应用方面比较广，可以多多接触一下</p>
<h3 id="未完待续。。。"><a href="#未完待续。。。" class="headerlink" title="未完待续。。。"></a>未完待续。。。</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/09/13/websocket/" data-id="cjp47gfaw000as820v44xcmf5" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/POI/">POI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/database/">database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/other/">other</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shiro/">shiro</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/中间件/">中间件</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/POI/" style="font-size: 20px;">POI</a> <a href="/tags/database/" style="font-size: 10px;">database</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/other/" style="font-size: 10px;">other</a> <a href="/tags/shiro/" style="font-size: 10px;">shiro</a> <a href="/tags/中间件/" style="font-size: 10px;">中间件</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/11/27/数据库/">数据库</a>
          </li>
        
          <li>
            <a href="/2018/11/15/git-server/">git server</a>
          </li>
        
          <li>
            <a href="/2018/10/31/书/">书</a>
          </li>
        
          <li>
            <a href="/2018/10/24/cors/">cors</a>
          </li>
        
          <li>
            <a href="/2018/10/17/权限验证/">权限验证</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 zerotop<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>